# Fail2Ban Telegram notification action
# 
# Author: Custom configuration for Nginx Proxy Manager
# 

[Definition]

# Option: actionstart
# Notes.: command executed once at the start of Fail2Ban.
actionstart = /usr/bin/curl -s -X POST "https://api.telegram.org/bot<token>/sendMessage" \
              -d "chat_id=<chat_id>" \
              -d "text=ğŸ›¡ï¸ **Fail2Ban Started**%%0A%%0AğŸ–¥ï¸ Host: <hostname>%%0AğŸ“… Time: $(date)" \
              -d "parse_mode=Markdown"

# Option: actionstop
# Notes.: command executed once at the end of Fail2Ban
actionstop = /usr/bin/curl -s -X POST "https://api.telegram.org/bot<token>/sendMessage" \
             -d "chat_id=<chat_id>" \
             -d "text=ğŸ›‘ **Fail2Ban Stopped**%%0A%%0AğŸ–¥ï¸ Host: <hostname>%%0AğŸ“… Time: $(date)" \
             -d "parse_mode=Markdown"

# Option: actioncheck
# Notes.: command executed once before each actionban command
actioncheck = 

# Option: actionban
# Notes.: command executed when banning an IP. Take care that the
#         command is executed with Fail2Ban user rights.
actionban = /usr/bin/curl -s -X POST "https://api.telegram.org/bot<token>/sendMessage" \
            -d "chat_id=<chat_id>" \
            -d "text=ğŸš¨ **SECURITY ALERT - IP BANNED**%%0A%%0AğŸ”´ **IP Address:** \`<ip>\`%%0AğŸ·ï¸ **Jail:** <name>%%0Aâš¡ **Failures:** <failures>%%0AğŸ• **Ban Time:** <bantime>s%%0AğŸ“… **Time:** $(date)%%0A%%0A**Log Lines:**%%0A\`\`\`%%0A<matches>%%0A\`\`\`" \
            -d "parse_mode=Markdown"

# Option: actionunban
# Notes.: command executed when unbanning an IP. Take care that the
#         command is executed with Fail2Ban user rights.
actionunban = /usr/bin/curl -s -X POST "https://api.telegram.org/bot<token>/sendMessage" \
              -d "chat_id=<chat_id>" \
              -d "text=âœ… **IP UNBANNED**%%0A%%0AğŸ”“ **IP Address:** \`<ip>\`%%0AğŸ·ï¸ **Jail:** <name>%%0AğŸ“… **Time:** $(date)" \
              -d "parse_mode=Markdown"

[Init]

# Default values for the variables used in the actions
token = YOUR_BOT_TOKEN
chat_id = YOUR_CHAT_ID
hostname = $(hostname)