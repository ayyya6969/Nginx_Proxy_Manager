# Fail2Ban filter for HTTP flood attacks
[Definition]
failregex = ^<HOST> -.*"(GET|POST|HEAD|PUT|DELETE|OPTIONS).*HTTP/1\.[01]" (200|201|202|204|301|302|304|400|401|403|404|405|409|410|422|429) .*$
ignoreregex = ^<HOST> -.*"(GET|POST|HEAD) .*(\.css|\.js|\.png|\.jpg|\.jpeg|\.gif|\.ico|\.svg|\.woff|\.woff2|\.ttf|\.eot|favicon\.ico).*HTTP/1\.[01]" (200|304|404) .*$
            ^<HOST> -.*"GET /health.*HTTP/1\.[01]" 200 .*$
            ^<HOST> -.*"GET /api/health.*HTTP/1\.[01]" 200 .*$

[Init]
maxlines = 1
journalmatch = _SYSTEMD_UNIT=nginx.service