# Fail2Ban filter for HTTP flood attacks - NPM log format
[Definition]
failregex = ^\[.*\] (200|201|202|204|301|302|304|400|401|403|404|405|409|410|422|429) - (GET|POST|HEAD|PUT|DELETE|OPTIONS) .* \[Client <HOST>\] .*$
ignoreregex = ^\[.*\] .* - (GET|POST|HEAD) .*(\.css|\.js|\.png|\.jpg|\.jpeg|\.gif|\.ico|\.svg|\.woff|\.woff2|\.ttf|\.eot|favicon\.ico) .* \[Client <HOST>\] .*$
            ^\[.*\] 200 - GET .*/health .* \[Client <HOST>\] .*$
            ^\[.*\] 200 - GET .*/api/health .* \[Client <HOST>\] .*$

[Init]
maxlines = 1